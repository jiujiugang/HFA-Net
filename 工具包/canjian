from PIL import Image
import os


# 处理文件夹中的所有图片
def resize_images_in_folder(input_dir, output_dir, target_size=(224, 224)):
    # 确保输出文件夹存在
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)

    # 遍历文件夹中的所有.png文件
    for filename in os.listdir(input_dir):
        if filename.endswith(".png"):
            file_path = os.path.join(input_dir, filename)

            # 打开图像
            with Image.open(file_path) as img:
                # 确保图像尺寸为225x224
                if img.size != target_size:
                    # 裁剪图像，去掉最后1像素（裁剪宽度为225，高度不变）
                    cropped_img = img.crop((0, 0, img.width - 1, img.height))
                    # 保存裁剪后的图像
                    output_image_path = os.path.join(output_dir, filename)
                    cropped_img.save(output_image_path)
                    print(f"Image {filename} resized and saved.")
                else:
                    # 如果图像已经是224x224，直接保存
                    output_image_path = os.path.join(output_dir, filename)
                    img.save(output_image_path)
                    print(f"Image {filename} is already the correct size.")


# 输入文件夹路径和输出文件夹路径
input_dir = r'D:\HTNet-master\NEW_MODEL\PPG_TU'  # 输入文件夹路径
output_dir = r'D:\HTNet-master\NEW_MODEL\PPG_TU_224'  # 输出文件夹路径

# 调用函数处理文件夹中的图像
resize_images_in_folder(input_dir, output_dir, target_size=(224, 224))
